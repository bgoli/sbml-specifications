% -*- TeX-master: "main"; fill-column: 72 -*-
%
\section{Examples}
\label{examples}

This section contains a variety of examples of SBML Level~3 Version~1
documents employing the Arrays package.

\subsection{Array of reactions}

This example creates an array {\tt cell} of 100 compartments, arrays for species {\tt A}, {\tt B}, and {\tt C} also of size 100 with each one placed in the corresponding compartment {\tt cell[i]}, and an array of 100 reactions with one within each {\tt cell[i]} converting {\tt A[i]} plus {\tt B[i]} into {\tt C[i]}.

\begin{example}
<!-- Specifies size of all arrays (i.e., n:=100) -->
<parameter id="n" value="100"...>
<!-- Create an array of n compartments -->
<listOfCompartments> 
 <compartment id="cell"...>
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions>
 </compartment>
</listOfCompartments> 
<listOfSpecies>
 <!-- Create array of n species A with A[i] placed in cell[i] -->
 <species id="A" compartment="cell" ... > 
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <arrays:listOfIndices>
   <arrays:index referencedAttribute="compartment" arrayDimension="0">
    <math><ci>i</ci></math>
   </arrays:index>
  </arrays:listOfIndices>
 </species>
 <!-- Create array of n species B with B[i] placed in cell[i] -->
 <species id="B" compartment="cell" ... > 
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <arrays:listOfIndices>
   <arrays:index referencedAttribute="compartment" arrayDimension="0">
    <math><ci>i</ci></math>
   </arrays:index>
  </arrays:listOfIndices>
 </species>
 <!-- Create array of n species C with C[i] placed in cell[i] -->
 <species id="C" compartment="cell" ... >
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <arrays:listOfIndices>
   <arrays:index referencedAttribute="compartment" arrayDimension="0">
    <math><ci>i</ci></math>
   </arrays:index>
  </arrays:listOfIndices>
 </species>
</listOfSpecies>
<!-- Create array of n reactions r with r[i] converting A[i] and B[i] into C[i]-->
<listOfReactions>
 <reaction id="r" ...> 
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <listOfReactants>
   <speciesReference species="A">
    <arrays:listOfIndices>
     <arrays:index referencedAttribute="species" arrayDimension="0">
      <math><ci>i</ci></math>
     </arrays:index>
    </arrays:listOfIndices>
   </speciesReference>
   <speciesReference species="B"> 
    <arrays:listOfIndices>
     <arrays:index referencedAttribute="species" arrayDimension="0">
      <math><ci>i</ci></math>
     </arrays:index>
    </arrays:listOfIndices>
   </speciesReference>
  </listOfReactants> 
  <listOfProducts>
   <speciesReference species="C"> 
    <arrays:listOfIndices>
     <arrays:index referencedAttribute="species" arrayDimension="0">
      <math><ci>i</ci></math>
     </arrays:index>
    </arrays:listOfIndices>
   </speciesReference>
  </listOfProducts>
 </reaction>
</listOfReactions>
\end{example}

% \subsection{Array of Parameters}

% \begin{verbatim}
% <listOfCompartments> 
%  <compartment id="cell"...>
%   <arrays:orderedListOfDimensions>
%    <arrays:dimension id="i" lowerLimit="1" upperLimit="100"/>
%   </arrays:orderedListOfDimensions>
% </compartment>
% </listOfCompartments> 
% <listOfParameters>
%  <parameter id="radius" ...> 
%   <arrays:orderedListOfDimensions>
%    <arrays:dimension id="i" lowerLimit="1" upperLimit="100"/>
%  </arrays:orderedListOfDimensions>
%  <parameter id="position" ...>
%   <arrays:orderedListOfDimensions>
%    <arrays:dimension id="i" lowerLimit="1" upperLimit="100"/>
%    <arrays:dimension id="j" lowerLimit="1" upperLimit="3"/>
%   </arrays:orderedListOfDimensions> 
%  </parameter>
% </listOfParameters>
% \end{verbatim}

\subsection{Array of rate rules}

\begin{eqnarray*}
\frac{dx[i]}{dt} & = & \left\{ \begin{array}{l}
  y,~~i = 1,2,3,4,5 \\
 2y,~~i = 6, 7, 8 
\end{array}
\right.
\end{eqnarray*}
\begin{example}
<listOfParameters>
 <!-- Create size variables for arrays -->
 <parameter id="n" value="8"/>
 <parameter id="m" value="5"/>
 <parameter id="o" value="3"/>
 <!-- Create array x of size n -->
 <parameter id="x" ...> 
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions>
 </parameter>
 <!-- Create scalar parameter y -->
 <parameter id="y" .../>
</listOfParameters>
<listOfRules>
 <!-- Create rate rules dx[i]/dt = y for i = 1,2,3,4,5 -->
 <rateRule variable="x">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="m" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <arrays:listOfIndices>
   <arrays:index referencedAttribute="variable" arrayDimension="0">
    <math><ci>i</ci></math>
   </arrays:index>
  </arrays:listOfIndices>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
   <ci>y</ci>
  </math>
 </rateRule>
 <!-- Create rate rules dx(i)/dt = 2*y for i = 6,7,8 -->
 <rateRule variable="x">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="o" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <arrays:listOfIndices>
   <arrays:index referencedAttribute="variable" arrayDimension="0">
    <math>
    <apply>
      <plus/>
       <ci>i</ci>
       <cn type="integer">5</cn>
     </apply>
    </math>
   </arrays:index>
  </arrays:listOfIndices>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
  <apply><times/>
   <cn type="integer">2</cn> <ci>y</ci>
  </apply></math> 
 </rateRule>
</listOfRules>
\end{example}

\subsection{Array of events}

\begin{eqnarray*}
\textup{If }x[i] > 1\textup{ then set }x[i] & = & \left\{ \begin{array}{l}
0.5,~~i = 1,2,3,4,5 \\
0.75,~~i = 6,7,8
\end{array}
\right.
\end{eqnarray*}

\begin{example}
<listOfParameters>
 <!-- Create size variables for arrays -->
 <parameter id="n" value="8"/>
 <parameter id="m" value="5"/>
 <parameter id="o" value="3"/>
 <!-- Create array x of size n -->
 <parameter id="x" ...> 
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions>
</listOfParameters>
<listOfEvents>
 <!-- Create events to set x[i] to 0.5 when x[i]>1 for i = 1,2,3,4,5 -->
 <event id="eventSmall">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="m" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <trigger>
   <math xmlns="http://www.w3.org/1998/Math/MathML">
     <apply>
       <gt/>
         <apply>
           <selector/>
           <ci>x</ci>
           <ci>i</ci>
         </apply>
       <cn type="integer">1</cn>
     </apply>
   </math>
  </trigger>
  <listOfEventAssignments>
   <eventAssignment variable="x">
    <arrays:listOfIndices>
     <arrays:index>
      <math>
       <ci>i</ci>
      </math>
     </arrays:index>
    </arrays:listOfIndices>
    <math xmlns="http://www.w3.org/1998/Math/MathML">
     <cn type="real">0.5</cn>
    </math>
   </eventAssignment>
  </listOfEventAssignments>
 </event>
 <!-- Create events to set x[i] to 0.75 when x[i]>1 for i = 6,7,8 -->
 <event id="eventBig">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="o" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <trigger>
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply>
        <gt/>
          <apply>
            <selector/>
            <ci>x</ci>
            <apply>
              <plus/>
                <ci>i</ci>
                <cn>5</cn>
            </apply>
          </apply>
          <cn type="integer">1</cn>
      </apply>
    </math>
  </trigger>
  <listOfEventAssignments>
   <eventAssignment variable="x">
    <arrays:listOfIndices>
     <arrays:index>
      <math>
       <apply>
          <plus/>
            <ci>i</ci>
            <cn type="integer">5</cn>
       </apply> 
      </math>
     </arrays:index>
    </arrays:listOfIndices>
    <math xmlns="http://www.w3.org/1998/Math/MathML">
     <cn type="real">0.75</cn>
    </math>
   </eventAssignment>
  </listOfEventAssignments>
 </event>
</listOfEvents>
\end{example}

\subsection{Initial assignment arrays}

This will set an the same initial value to all 10 elements of the x array.

\begin{example}
<listOfParameters>
 <!-- Set size n=10 -->
 <parameter id="n" value="10"/>
 <!-- Set array parameters x(i)=5.7 for all i=1,...,10 -->
 <parameter id="x" value="5.7"...>
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0">
  </arrays:listOfDimensions> 
 </parameter>
</listOfParameters>
\end{example}

This could also be done with an initial assignment.

\begin{example}
<listOfParameters> 
  <!-- Set size n=10 -->
  <parameter id="n" value="10"/>
  <!-- Create an array x of size n -->
  <parameter id="x"...>
    <arrays:listOfDimensions>
      <arrays:dimension id="i" size="n" arrayDimension="0"/> 
    </arrays:listOfDimensions>
  </parameter> ...
</listOfParameters> ...
<listOfInitialAssignments>
  <!-- Set array parameters x(i)=5.7 for all i=1,...,10 -->
  <initialAssignment variable="x">
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <cn type="real">5.7</cn>
    </math>
  </initialAssignment>
</listOfInitialAssignments>
\end{example}

Here is an example where half of the array is assigned 5.7 and the other half is 3.2. 

\begin{example}
<listOfParameters> 
 <!-- Set size n=10 -->
 <parameter id="n" value="10"/>
 <!-- Set size m=5 -->
 <parameter id="m" value="5"/>
 <!-- Create an array x of size n -->
 <parameter id="x"...>
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/> 
  </arrays:listOfDimensions>
 </parameter> ...
</listOfParameters> ...
<listOfInitialAssignments>
 <!-- Set array parameters x[i]=5.7 for i=1,...,5 -->
 <initialAssignment variable="x"> 
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="m" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <arrays:listOfIndices>
   <arrays:index>
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <ci>i</ci>
    </math>
   </arrays:index>
  </arrays:listOfIndices>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <cn type="real">5.7<cn>
  </math>
 </initialAssignment>
 <!-- Set array parameters x[i]=3.2 for i=6,...,10 -->
 <initialAssignment variable="x">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="m" arrayDimension="0"/>
  </arrays:listOfDimensions>
  <arrays:listOfIndices>
   <arrays:index>
    <math xmlns="http://www.w3.org/1998/Math/MathML">
     <apply>
       <plus/>
        <ci>i</ci>
        <ci>m</ci>
     </apply>
    </math>
   </arrays:index>
  </arrays:listOfIndices>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <cn type="real">3.2<cn>
  </math>
 </initialAssignment>
</listOfInitialAssignments>
\end{example}

This could also be done using the {\tt vector} operator.

\begin{example}
<initialAssignment variable="x"> 
 <math xmlns="http://www.w3.org/1998/Math/MathML">
  <vector> 
   <cn>5.7</cn> 
   <cn>5.7</cn> 
   <cn>5.7</cn> 
   <cn>5.7</cn> 
   <cn>5.7</cn> 
   <cn>3.2</cn> 
   <cn>3.2</cn> 
   <cn>3.2</cn> 
   <cn>3.2</cn> 
   <cn>3.2</cn>
  </vector>
 </math>
</initialAssignment>
\end{example}

% The {\tt matrix} and {\tt matrixrow} operators can also be used for initial assignments.

% \begin{verbatim}
% <listOfParameters>
%  <!-- Create size variable n=3 -->
%  <parameter id="n" value="3"> 
%  <!-- Create a two dimensional array of size n by n -->
%  <parameter id="Ident" value="0"> 
%   <arrays:listOfDimensions>
%    <arrays:dimension id="i" size="n" arrayDimension="0"/>
%    <arrays:dimension id="j" size="n" arrayDimension="1"/>
%   </arrays:listOfDimensions>
%  </parameter>
% </listOfParameters>
% <listOfInitialAssignments>
%  <!-- Assign Ident to the identity matrix -->
%  <initialAssignment variable="Ident">
%   <math>
%    <matrix> 
%     <matrixrow> <cn>1</cn> <cn>0</cn> <cn>0</cn> </matrixrow>
%     <matrixrow> <cn>0</cn> <cn>1</cn> <cn>0</cn> </matrixrow> 
%     <matrixrow> <cn>0</cn> <cn>0</cn> <cn>1</cn> </matrixrow> 
%    </matrix>
%   </math> 
%  </initialAssignment>
% </listOfInitialAssignments>
% \end{verbatim}

Here is an example to assign a single value. 

\begin{example}
<initialAssignment variable="Ident"> 
 <arrays:listOfIndices>
  <arrays:index>
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <ci>2</ci>
    </math>
  </arrays:index>
  <arrays:index>
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <ci>1</ci>
    </math>
  </arrays:index>
 </arrays:listOfIndices>
 <math xmlns="http://www.w3.org/1998/Math/MathML">
  <cn type="integer">14<cn>
 </math>
<initialAssignment>
\end{example}

\subsection{Examples for array referencing}

Here is an example array reference using {\tt selector}.
\begin{displaymath}
0.1 * s1[x]
\end{displaymath}
\begin{example}
<math xmlns="http://www.w3.org/1998/Math/MathML">
 <apply>
  <times/>
   <apply>
    <selector/>
     <ci> s1 </ci>
     <ci> x </ci> 
   </apply>
   <cn> 0.1 </cn>
 </apply>
</math>
\end{example}

Here is a more complicated example of array referencing.
\begin{displaymath}
w[i]= A[i][1]v[1]+ A[i][2]v[2]+ A[i][3]v[3]
\end{displaymath}

\begin{example}
<listOfParameters> 
 <!-- Create size variable n=3 -->
 <parameter id="n" value="3".../>
 <!-- Create 2-dimensional array A of size n by n -->
 <parameter id="A">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/> 
   <arrays:dimension id="j" size="n" arrayDimension="1"/>
  </arrays:listOfDimensions> 
 </parameter> 
 <!-- Create an array v of size n -->
 <parameter id="v">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions> 
 </parameter> 
 <!-- Create an array w of size n -->
 <parameter id="w">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions> 
 </parameter>
</listOfParameters>
<listOfRules>
 <!-- w(i) = A(i,1)v(1) + A(i,2)v(2) + A(i,3)v(3) -->
 <assignmentRule variable="w">
  <arrays:listOfDimensions>
   <arrays:dimension id="i" size="n" arrayDimension="0"/>
  </arrays:listOfDimensions> 
  <arrays:listOfIndices>
   <arrays:index referencedAttribute="variable" arrayDimension="0">
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <ci>i</ci>
    </math>
   </arrays:index>
  </arrays:listOfIndices>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
   <apply><plus/>
    <apply><times/>
     <apply><selector/><ci>A</ci><ci>i</ci><cn type="integer">1</cn></apply>
     <apply><selector/><ci>v</ci><cn type="integer">1</cn></apply>
    </apply>
    <apply><times/>
     <apply><selector/><ci>A</ci><ci>i</ci><cn type="integer">2</cn></apply>
     <apply><selector/><ci>v</ci><cn type="integer">2</cn></apply>
    </apply>
    <apply><times/>
     <apply><selector/><ci>A</ci><ci>i</ci><cn type="integer">3</cn></apply>
     <apply><selector/><ci>v</ci><cn type="integer">3</cn></apply>
    </apply>
   </apply>
  </math>
 </assignmentRule>
</listOfRules>
\end{example}

% This could also be done with {\tt scalarproduct} as follows:

% \begin{example}
% <assignmentRule variable="w">
%  <math xmlns="http://www.w3.org/1998/Math/MathML">
%   <apply>
%    <ci>scalarproduct</ci>
%    <ci>A</ci>
%    <ci>v</ci>
%   </apply>
%  </math>
% </assignmentRule>
% \end{example}

\subsection{Array references in functions}

Functions can also make reference to array variables, but in this case, it is not necessary to declare arrays as such within the function or to declare the array indices or limits within functions.  The following defines a function on two vectors, 
\begin{eqnarray*}
f(x,y) & = & x[2]y[1] - y[2]x[1]
\end{eqnarray*}
The arguments are declared as vectors using the type field of the ci command.

\begin{example}
<!-- f(x,y) = x[2]y[1] - y[2]x[1] -->
<functionDefinition id="f" />
 <math xmlns="http://www.w3.org/1998/Math/MathML">
  <lambda>
   <bvar>
    <ci>x</ci>
   </bvar>
   <bvar>
    <ci>y</ci>
   </bvar>
   <apply>
     <minus/>
       <apply>
         <times/>
           <apply>
             <ci>selector</ci>
             <ci>x</ci>
             <cn type="integer">2</cn>
           </apply>
           <apply>
             <ci>selector</ci>
             <ci>y</ci>
             <cn type="integer">1</cn>
           </apply>
       </apply>
       <apply>
         <times/>
           <apply>
             <ci>selector</ci>
             <ci>x</ci>
             <cn type="integer">1</cn>
           </apply>
           <apply>
             <ci>selector</ci>
             <ci>y</ci>
             <cn type="integer">2</cn>
           </apply>
       </apply>
   </apply>
  </lambda>
 </math>
</functionDefinition>
\end{example}

% -*- TeX-master: "main"; fill-column: 72 -*-

\section{Validation of SBML documents}
\label{apdx-validation}

\subsection{Validation and consistency rules}
\label{validation-rules}

This section summarizes all the conditions that must (or in some cases,
at least \emph{should}) be true of an SBML Level~3 Version~1 model that
uses the \DistributionsPackage. We use the same conventions as are used
in the SBML Level~3 Version~1 Core specification document. In
particular, there are different degrees of rule strictness. Formally,
the differences are expressed in the statement of a rule: either a rule
states that a condition \emph{must} be true, or a rule states that it
\emph{should} be true. Rules of the former kind are strict SBML
validation rules---a model encoded in SBML must conform to all of them
in order to be considered valid. Rules of the latter kind are
consistency rules. To help highlight these differences, we use the
following three symbols next to the rule numbers:

\begin{description}

\item[\hspace*{6.5pt}\vSymbol\vsp] A \vSymbolName indicates a
\emph{requirement} for SBML conformance. If a model does not follow this
rule, it does not conform to the \DistributionsPackage specification.
(Mnemonic intention behind the choice of symbol: ``This must be
checked.'')

\item[\hspace*{6.5pt}\cSymbol\csp] A \cSymbolName indicates a
\emph{recommendation} for model consistency. If a model does not follow
this rule, it is not considered strictly invalid as far as the
\DistributionsPackage specification is concerned; however, it indicates
that the model contains a physical or conceptual inconsistency.
(Mnemonic intention behind the choice of symbol: ``This is a cause for
warning.'')

\item[\hspace*{6.5pt}\mSymbol\msp] A \mSymbolName indicates a strong
recommendation for good modeling practice. This rule is not strictly a
matter of SBML encoding, but the recommendation comes from logical
reasoning. As in the previous case, if a model does not follow this
rule, it is not strictly considered an invalid SBML encoding. (Mnemonic
intention behind the choice of symbol: ``You're a star if you heed
this.'')

\end{description}

The validation rules listed in the following subsections are all stated
or implied in the rest of this specification document. They are
enumerated here for convenience. Unless explicitly stated, all
validation rules concern objects and attributes specifically defined in
the \DistributionsPackage package.

For \notice convenience and brevity, we use the shorthand
``\token{distrib:\-x}'' to stand for an attribute or element name
\token{x} in the namespace for the \DistributionsPackage package, using
the namespace prefix \token{distrib}. In reality, the prefix string may
be different from the literal ``\token{distrib}'' used here (and indeed,
it can be any valid XML namespace prefix that the modeler or software
chooses). We use ``\token{distrib:\-x}'' because it is shorter than to
write a full explanation everywhere we refer to an attribute or element
in the \DistributionsPackage namespace.

Attributes from this package are listed in these rules as having the \val{distrib:} prefix, but as is convention for SBML packages, this prefix is optional.

\subsubsection*{General rules about this package}

\validRule{distrib-10101}{To conform to the \DistributionsPackage
specification for SBML Level~3 Version~1, an SBML document must declare
\uri{http://www.sbml.org/sbml/level3/version1/distrib/version1} as the
XMLNamespace to use for elements of this package. (Reference: SBML
Level~3 Specification for Distributions, Version~1
\sec{xml-namespace}.)}

\validRule{distrib-10102}{Wherever they appear in an SBML document,
elements and attributes from the \DistributionsPackage must use the
\uri{http://www.sbml.org/sbml/level3/version1/distrib/version1}
namespace, declaring so either explicitly or implicitly. (Reference:
SBML Level~3 Specification for Distributions, Version~1
\sec{xml-namespace}.)}

\subsubsection*{General rules about identifiers}

\validRule{distrib-10301}{(Extends validation rule \#10301 in the
\sbmlthreecore specification. TO DO list scope of ids) (Reference: SBML
Level~3 Version~1 Core, Section~3.1.7.)}

\validRule{distrib-10302}{The value of a \token{distrib:\-id} must
conform to the syntax of the \class{SBML} data type \primtype{SId}
(Reference: SBML Level~3 Version~1 Core, Section~3.1.7.)}

\TODO{ANY LIST OF ELEMENTS THAT HAVE ATTRIBUTES}

\subsubsection*{Rules for the extended \class{SBML} class}

\validRule{distrib-20101}{In all SBML documents using the
\DistributionsPackage, the \class{SBML} object must have the
\token{distrib:\-required} attribute. (Reference: SBML Level~3 Version~1
Core, Section~4.1.2.)}

\validRule{distrib-20102}{The value of attribute
\token{distrib:\-required} on the \class{SBML} object must be of data
type \primtype{boolean}. (Reference: SBML Level~3 Version~1 Core,
Section~4.1.2.)}

\validRule{distrib-20103}{The value of attribute
\token{distrib:\-required} on the \class{SBML} object must be set to
\val{true}. (Reference: SBML Level~3 Specification for Distributions,
Version~1 \sec{xml-namespace}.)}

\subsubsection*{Rules for extended \class{SBase} object}

\validRule{distrib-20201}{A \SBase object may contain one and only one
instance of the \Uncertainty element. No other elements from the SBML
Level~3 Distributions namespaces are permitted on a \SBase object.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{extended-sbase-class}.)}


\subsubsection*{Rules for \class{Distribution} object}

\validRule{distrib-20301}{A \Distribution object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
a \Distribution. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20302}{A \Distribution object may have the optional
SBML Level~3 Core subobjects for notes and annotations. No other
elements from the SBML Level~3 Core namespaces are permitted on a
\Distribution. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20303}{A \Distribution object may contain one and
only one instance of the ASTNode element. No other elements from the
SBML Level~3 Distributions namespaces are permitted on a \Distribution
object. (Reference: SBML Level~3 Specification for Distributions,
Version~1, \sec{distribution-class}.)}


\subsubsection*{Rules for \class{UncertValue} object}

\validRule{distrib-20401}{An \UncertValue object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
an \UncertValue. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20402}{An \UncertValue object may have the optional
SBML Level~3 Core subobjects for notes and annotations. No other
elements from the SBML Level~3 Core namespaces are permitted on an
\UncertValue. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20403}{An \UncertValue object may have the optional
attributes \token{distrib:\-value}, \token{distrib:\-var} and
\token{distrib:\-units}. No other attributes from the SBML Level~3
Distributions namespaces are permitted on an \UncertValue object.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertvalue-class}.)}

\validRule{distrib-20404}{The attribute \token{distrib:\-value} on an
\UncertValue must have a value of data type \token{double}. (Reference:
SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertvalue-class}.)}

\validRule{distrib-20405}{The value of the attribute
\token{distrib:\-var} of an \UncertValue object must be the identifier
of an existing object derived from the \SBase class and defined in the
enclosing \Model object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{uncertvalue-class}.)}

\validRule{distrib-20406}{The value of the attribute
\token{distrib:\-units} on an \UncertValue must have a taken from the
following: the identifier of a \UnitDefinition object in the enclosing
\Model, or one of the base units in SBML. (Reference: SBML Level~3
Specification for Distributions, Version~1, \sec{uncertvalue-class}.)}


\subsubsection*{Rules for \class{ExternalParameter} object}

\validRule{distrib-20501}{An \ExternalParameter object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on an \ExternalParameter. (Reference: SBML
Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20502}{An \ExternalParameter object may have the
optional SBML Level~3 Core subobjects for notes and annotations. No
other elements from the SBML Level~3 Core namespaces are permitted on an
\ExternalParameter. (Reference: SBML Level~3 Version~1 Core,
Section~3.2.)}

\validRule{distrib-20503}{An \ExternalParameter object must have the
required attribute \token{distrib:\-definitionURL}. No other attributes
from the SBML Level~3 Distributions namespaces are permitted on an
\ExternalParameter object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{externalparameter-class}.)}

\validRule{distrib-20504}{An \ExternalParameter object may contain one
and only one instance of the \ListOfExternalParameters element. No other
elements from the SBML Level~3 Distributions namespaces are permitted on
an \ExternalParameter object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{externalparameter-class}.)}

\validRule{distrib-20505}{The attribute \token{distrib:\-definitionURL}
on an \ExternalParameter must have a value of data type \token{string}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{externalparameter-class}.)}

\validRule{distrib-20506}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfExternalParameters
container object may only contain \ExternalParameter objects.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}

\validRule{distrib-20507}{A \ListOfExternalParameters object may have
the optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on a \ListOfExternalParameters object.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}

\validRule{distrib-20508}{An \ListOfExternalParameters object may have
the optional attributes \token{distrib:\-id} and \token{distrib:\-name}.
No other attributes from the SBML Level~3 Distributions namespaces are
permitted on an \ListOfExternalParameters object. (Reference: SBML
Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}

\validRule{distrib-20509}{The attribute \token{distrib:\-name} on an
\ListOfExternalParameters must have a value of data type \token{string}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}


\subsubsection*{Rules for \class{Uncertainty} object}

\validRule{distrib-20601}{An \Uncertainty object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
an \Uncertainty. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20602}{An \Uncertainty object may have the optional
SBML Level~3 Core subobjects for notes and annotations. No other
elements from the SBML Level~3 Core namespaces are permitted on an
\Uncertainty. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20603}{An \Uncertainty object may contain one and
only one instance of each of the UncertValue, UncertValue, UncertValue,
UncertValue, UncertValue, UncertValue, UncertValue, UncertValue,
UncertValue, UncertValue, UncertStatisticSpan, UncertStatisticSpan,
UncertStatisticSpan, UncertStatisticSpan, \ListOfExternalParameters and
Distribution elements. No other elements from the SBML Level~3
Distributions namespaces are permitted on an \Uncertainty object.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertainty-class}.)}

\validRule{distrib-20604}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfExternalParameters
container object may only contain \ExternalParameter objects.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}

\validRule{distrib-20605}{A \ListOfExternalParameters object may have
the optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on a \ListOfExternalParameters object.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}

\validRule{distrib-20606}{An \ListOfExternalParameters object may have
the optional attributes \token{distrib:\-id} and \token{distrib:\-name}.
No other attributes from the SBML Level~3 Distributions namespaces are
permitted on an \ListOfExternalParameters object. (Reference: SBML
Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}

\validRule{distrib-20607}{The attribute \token{distrib:\-name} on an
\ListOfExternalParameters must have a value of data type \token{string}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{listofexternalparameters-class}.)}


\subsubsection*{Rules for \class{UncertStatisticSpan} object}

\validRule{distrib-20701}{An \UncertStatisticSpan object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on an \UncertStatisticSpan. (Reference: SBML
Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20702}{An \UncertStatisticSpan object may have the
optional SBML Level~3 Core subobjects for notes and annotations. No
other elements from the SBML Level~3 Core namespaces are permitted on an
\UncertStatisticSpan. (Reference: SBML Level~3 Version~1 Core,
Section~3.2.)}

\validRule{distrib-20703}{An \UncertStatisticSpan object may have the
optional attributes \token{distrib:\-varLower},
\token{distrib:\-valueLower}, \token{distrib:\-varUpper} and
\token{distrib:\-valueUpper}. No other attributes from the SBML Level~3
Distributions namespaces are permitted on an \UncertStatisticSpan
object. (Reference: SBML Level~3 Specification for Distributions,
Version~1, \sec{uncertstatisticspan-class}.)}

\validRule{distrib-20704}{The value of the attribute
\token{distrib:\-varLower} of an \UncertStatisticSpan object must be the
identifier of an existing object derived from the \SBase class and
defined in the enclosing \Model object. (Reference: SBML Level~3
Specification for Distributions, Version~1,
\sec{uncertstatisticspan-class}.)}

\validRule{distrib-20705}{The attribute \token{distrib:\-valueLower} on
an \UncertStatisticSpan must have a value of data type \token{double}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertstatisticspan-class}.)}

\validRule{distrib-20706}{The value of the attribute
\token{distrib:\-varUpper} of an \UncertStatisticSpan object must be the
identifier of an existing object derived from the \SBase class and
defined in the enclosing \Model object. (Reference: SBML Level~3
Specification for Distributions, Version~1,
\sec{uncertstatisticspan-class}.)}

\validRule{distrib-20707}{The attribute \token{distrib:\-valueUpper} on
an \UncertStatisticSpan must have a value of data type \token{double}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertstatisticspan-class}.)}


\subsubsection*{Rules for \class{DistribBase} object}

\validRule{distrib-20801}{A \DistribBase object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
a \DistribBase. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20802}{A \DistribBase object may have the optional
SBML Level~3 Core subobjects for notes and annotations. No other
elements from the SBML Level~3 Core namespaces are permitted on a
\DistribBase. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20803}{A \DistribBase object may have the optional
attributes \token{distrib:\-id} and \token{distrib:\-name}. No other
attributes from the SBML Level~3 Distributions namespaces are permitted
on a \DistribBase object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{distribbase-class}.)}

\validRule{distrib-20804}{The attribute \token{distrib:\-name} on a
\DistribBase must have a value of data type \token{string}. (Reference:
SBML Level~3 Specification for Distributions, Version~1,
\sec{distribbase-class}.)}



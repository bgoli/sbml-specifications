% -*- TeX-master: "main"; fill-column: 72 -*-

\section{Validation of SBML documents}
\label{apdx-validation}

\subsection{Validation and consistency rules}
\label{validation-rules}

This section summarizes all the conditions that must (or in some cases,
at least \emph{should}) be true of an SBML Level~3 Version~1 model that
uses the \DistributionsPackage. We use the same conventions as are used
in the SBML Level~3 Version~1 Core specification document. In
particular, there are different degrees of rule strictness. Formally,
the differences are expressed in the statement of a rule: either a rule
states that a condition \emph{must} be true, or a rule states that it
\emph{should} be true. Rules of the former kind are strict SBML
validation rules---a model encoded in SBML must conform to all of them
in order to be considered valid. Rules of the latter kind are
consistency rules. To help highlight these differences, we use the
following three symbols next to the rule numbers:

\begin{description}

\item[\hspace*{6.5pt}\vSymbol\vsp] A \vSymbolName indicates a
\emph{requirement} for SBML conformance. If a model does not follow this
rule, it does not conform to the \DistributionsPackage specification.
(Mnemonic intention behind the choice of symbol: ``This must be
checked.'')

\item[\hspace*{6.5pt}\cSymbol\csp] A \cSymbolName indicates a
\emph{recommendation} for model consistency. If a model does not follow
this rule, it is not considered strictly invalid as far as the
\DistributionsPackage specification is concerned; however, it indicates
that the model contains a physical or conceptual inconsistency.
(Mnemonic intention behind the choice of symbol: ``This is a cause for
warning.'')

\item[\hspace*{6.5pt}\mSymbol\msp] A \mSymbolName indicates a strong
recommendation for good modeling practice. This rule is not strictly a
matter of SBML encoding, but the recommendation comes from logical
reasoning. As in the previous case, if a model does not follow this
rule, it is not strictly considered an invalid SBML encoding. (Mnemonic
intention behind the choice of symbol: ``You're a star if you heed
this.'')

\end{description}

The validation rules listed in the following subsections are all stated
or implied in the rest of this specification document. They are
enumerated here for convenience. Unless explicitly stated, all
validation rules concern objects and attributes specifically defined in
the \DistributionsPackage package.

For \notice convenience and brevity, we use the shorthand
``\token{distrib:\-x}'' to stand for an attribute or element name
\token{x} in the namespace for the \DistributionsPackage package, using
the namespace prefix \token{distrib}. In reality, the prefix string may
be different from the literal ``\token{distrib}'' used here (and indeed,
it can be any valid XML namespace prefix that the modeler or software
chooses). We use ``\token{distrib:\-x}'' because it is shorter than to
write a full explanation everywhere we refer to an attribute or element
in the \DistributionsPackage namespace.

Attributes from this package are listed in these rules as having the \val{distrib:} prefix, but as is convention for SBML packages, this prefix is optional.

\subsubsection*{General rules about this package}

\validRule{distrib-10101}{To conform to the \DistributionsPackage
specification for SBML Level~3 Version~1, an SBML document must declare
\uri{http://www.sbml.org/sbml/level3/version1/distrib/version1} as the
XMLNamespace to use for elements of this package. (Reference: SBML
Level~3 Specification for Distributions, Version~1
\sec{xml-namespace}.)}

\validRule{distrib-10102}{Wherever they appear in an SBML document,
elements and attributes from the \DistributionsPackage must use 
\uri{http://www.sbml.org/sbml/level3/version1/distrib/version1} as the
namespace, declaring so either explicitly or implicitly.
(Reference: SBML Level~3 Specification for Distributions, Version~1 \sec{xml-namespace}.)}

\subsubsection*{General rules for MathML content}

\validRule{distrib-10205}{(Extends validation rule \#10205 in the \sbmlthreecore specification.)  The allowed values for the attribute \token{definitionURL} on a \token{csymbol} are extended to additionally allow\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-normal},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-uniform},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-bernoulli},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-binomial},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-cauchy},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-chisquare},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-exponential},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-gamma},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-laplace},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-lognormal},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-poisson}, and\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-rayleigh}.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{sec:extended-math})}

\validRule{distrib-10250}{Any MathML \token{csymbol} element with a \token{definitionURL} of\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-normal},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-binomial},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-gamma}, or\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-lognormal}
must have exactly two or four children.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{sec:extended-math})}

\validRule{distrib-10251}{Any MathML \token{csymbol} element with a \token{definitionURL} of\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-uniform}
must have exactly two children.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{sec:extended-math})}

\validRule{distrib-10252}{Any MathML \token{csymbol} element with a \token{definitionURL} of\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-bernoulli},
must have exactly one child.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{sec:extended-math})}

\validRule{distrib-10253}{Any MathML \token{csymbol} element with a \token{definitionURL} of\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-cauchy} \\or
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-laplace}
must have exactly one, two, or four children.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{sec:extended-math})}

\validRule{distrib-10254}{Any MathML \token{csymbol} element with a \token{definitionURL} of\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-chisquare},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-exponential},\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-poisson}, or\\
\val{http://\-www.\-sbml.\-org/\-sbml/\-symbols/\-distrib/\-rayleigh}
must have exactly one or three children.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{sec:extended-math})}

\subsubsection*{General rules about identifiers}

\validRule{distrib-10301}{(Extends validation rule \#10301 in the
\sbmlthreecore specification.)  The \token{distrib:id} attribute of every \ListOfUncertainties, \Uncertainty, \UncertParameter, and \UncertSpan is added to the general SId namespace of the \Model, and must be unique among all core or other package \token{id} values also added to the same namespace.
(Reference: SBML Level~3 Version~1 Core, Section~3.1.7.)}

\validRule{distrib-10302}{The value of a \token{distrib:\-id} must
conform to the syntax of the \class{SBML} data type \primtype{SId}
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{distribbase-class}.)}

\validRule{distrib-10303}{The value of a \token{distrib:\-name} must have a value of data type \token{string}.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{distribbase-class}.)}


\subsubsection*{Rules for the extended \class{SBML} class}

\validRule{distrib-20101}{In all SBML documents using the
\DistributionsPackage, the \class{SBML} object must have the
\token{distrib:\-required} attribute. (Reference: SBML Level~3 Version~1
Core, Section~4.1.2.)}

\validRule{distrib-20102}{The value of attribute
\token{distrib:\-required} on the \class{SBML} object must be of data
type \primtype{boolean}. (Reference: SBML Level~3 Version~1 Core,
Section~4.1.2.)}

\validRule{distrib-20103}{The value of attribute
\token{distrib:\-required} on the \class{SBML} object must be set to
\val{true}. (Reference: SBML Level~3 Specification for Distributions,
Version~1 \sec{xml-namespace}.)}

\subsubsection*{Rules for extended \class{SBase} object}

\validRule{distrib-20201}{An \SBase object may contain one and only one
instance of the \ListOfUncertainties element. No other elements from the
SBML Level~3 Distributions namespaces are permitted on an \SBase object.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{extended-sbase-class}.)}

\validRule{distrib-20202}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfUncertainties
container object may only contain \Uncertainty objects. (Reference: SBML
Level~3 Specification for Distributions, Version~1,
\sec{extended-sbase-class}.)}

\validRule{distrib-20203}{A \ListOfUncertainties object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on a \ListOfUncertainties object. (Reference:
SBML Level~3 Specification for Distributions, Version~1,
\sec{extended-sbase-class}.)}


\subsubsection*{Rules for \class{UncertParameter} object}

\validRule{distrib-20301}{An \UncertParameter object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on an \UncertParameter. (Reference: SBML
Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20302}{An \UncertParameter object may have the
optional SBML Level~3 Core subobjects for notes and annotations. No
other elements from the SBML Level~3 Core namespaces are permitted on an
\UncertParameter. (Reference: SBML Level~3 Version~1 Core,
Section~3.2.)}

\validRule{distrib-20303}{An \UncertParameter object must have the
required attribute \token{distrib:\-type}, and may have the optional
attributes \token{distrib:\-id}, \token{distrib:\-name}, \token{distrib:\-value}, \token{distrib:\-var},
\token{distrib:\-units} and \token{distrib:\-defini\-tion\-URL}. No other
attributes from the SBML Level~3 Distributions namespaces are permitted
on an \UncertParameter object. (Reference: SBML Level~3 Specification
for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20304}{An \UncertParameter object may contain one and
only one instance of each of the \ListOfUncertParameters and ASTNode
elements. No other elements from the SBML Level~3 Distributions
namespaces are permitted on an \UncertParameter object. (Reference: SBML
Level~3 Specification for Distributions, Version~1,
\sec{uncertparameter-class}.)}

\validRule{distrib-20305}{The value of the attribute
\token{distrib:\-type} of an \UncertParameter object may only be a subset of the values allowed in an SBML data type \primtype{UncertType}; that is, the
value must be one of the following: \val{distribution},
\val{exter\-nal\-Pa\-ra\-meter}, \val{coeffientOfVariation}, \val{kurtosis},
\val{mean}, \val{median}, \val{mode}, \val{sampleSize}, \val{skewness},
\val{standardDeviation}, \val{stan\-dard\-Er\-ror}, or \val{variance}.
(Reference: SBML Level~3
Specification for Distributions, Version~1,
\sec{uncertparameter-class}.)}

\validRule{distrib-20306}{The attribute \token{distrib:\-value} on an
\UncertParameter must have a value of data type \token{double}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertparameter-class}.)}

\validRule{distrib-20307}{The value of the attribute
\token{distrib:\-var} of an \UncertParameter object must be the
identifier of an existing object derived from the \SBase class and
defined in the enclosing \Model object. (Reference: SBML Level~3
Specification for Distributions, Version~1,
\sec{uncertparameter-class}.)}

\validRule{distrib-20308}{The value of the attribute
\token{distrib:\-units} on an \UncertParameter must be taken from
the following: the identifier of a \UnitDefinition object in the
enclosing \Model, or one of the base units in SBML. (Reference: SBML
Level~3 Specification for Distributions, Version~1,
\sec{uncertparameter-class}.)}

\validRule{distrib-20309}{The attribute \token{distrib:\-definitionURL}
on an \UncertParameter must have a value of data type \token{string}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertparameter-class}.)}

\validRule{distrib-20310}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfUncertParameters
container object may only contain \UncertParameter objects. (Reference:
SBML Level~3 Specification for Distributions, Version~1,
\sec{listofuncertparameters-class}.)}

\validRule{distrib-20311}{A \ListOfUncertParameters object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on a \ListOfUncertParameters object.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{listofuncertparameters-class}.)}

\validRule{distrib-20312}{A \ListOfUncertParameters object may have the optional
attributes \token{distrib:\-id} and \token{distrib:\-name}. No other
attributes from the SBML Level~3 Distributions namespaces are permitted
on an \UncertSpan object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{listofuncertparameters-class}.)}

\validRule{distrib-20350}{An \UncertParameter object may define either the attribute \token{distrib:\-value} or \token{distrib:\-var}, but not both.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20351}{An \UncertParameter object may define either the attribute \token{distrib:\-value} or \token{distrib:\-var}, but not both.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20352}{An \UncertParameter object with a \token{type} of
\val{coeffientOfVariation}, \val{kurtosis},
\val{mean}, \val{median}, \val{mode}, \val{sampleSize}, \val{skewness},
\val{standardDeviation}, \val{standardError}, or \val{variance}
may not define the attribute \token{distrib:\-definitionURL}.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20353}{An \UncertParameter object with a \token{type} of
\val{coeffientOfVariation}, \val{kurtosis},
\val{mean}, \val{median}, \val{mode}, \val{sampleSize}, \val{skewness},
\val{standardDeviation}, \val{standardError}, or \val{variance}
may not define a child \Math or \ListOfUncertParameters object.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20354}{An \UncertParameter object with a \token{type} of
\val{distribution} may not define the attributes \token{distrib:\-value} or \token{distrib:\-var}.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}



\subsubsection*{Rules for \class{Uncertainty} object}

\validRule{distrib-20401}{An \Uncertainty object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
an \Uncertainty. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20402}{An \Uncertainty object may have the optional
SBML Level~3 Core subobjects for notes and annotations. No other
elements from the SBML Level~3 Core namespaces are permitted on an
\Uncertainty. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20403}{An \Uncertainty object may contain one and
only one instance of the \ListOfUncertParameters element. No other
elements from the SBML Level~3 Distributions namespaces are permitted on
an \Uncertainty object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{uncertainty-class}.)}

\validRule{distrib-20404}{An \Uncertainty object may have the optional
attributes \token{distrib:\-id} and \token{distrib:\-name}. No other
attributes from the SBML Level~3 Distributions namespaces are permitted
on an \UncertSpan object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{uncertainty-class}.)}



\subsubsection*{Rules for \class{UncertSpan} object}

\validRule{distrib-20501}{An \UncertSpan object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
an \UncertSpan. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20502}{An \UncertSpan object may have the optional
SBML Level~3 Core subobjects for notes and annotations. No other
elements from the SBML Level~3 Core namespaces are permitted on an
\UncertSpan. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{distrib-20503}{An \UncertSpan object must have the
required attribute \token{distrib:\-type}, and may have the optional
attributes \token{distrib:\-id}, \token{distrib:\-name}, \token{distrib:\-value}, \token{distrib:\-var},
\token{distrib:\-units} and \token{distrib:\-defini\-tion\-URL}, \token{dist\-rib:\-varLower}, \token{distrib:\-value\-Lower},
\token{distrib:\-varUpper} and \token{distrib:\-valueUpper}. No other
attributes from the SBML Level~3 Distributions namespaces are permitted
on an \UncertSpan object. (Reference: SBML Level~3 Specification for
Distributions, Version~1, \sec{uncertspan-class}.)}

\validRule{distrib-20504}{The value of the attribute
\token{distrib:\-varLower} of an \UncertSpan object must be the
identifier of an existing object derived from the \SBase class and
defined in the enclosing \Model object. (Reference: SBML Level~3
Specification for Distributions, Version~1, \sec{uncertspan-class}.)}

\validRule{distrib-20505}{The attribute \token{distrib:\-valueLower} on
an \UncertSpan must have a value of data type \token{double}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertspan-class}.)}

\validRule{distrib-20506}{The value of the attribute
\token{distrib:\-varUpper} of an \UncertSpan object must be the
identifier of an existing object derived from the \SBase class and
defined in the enclosing \Model object. (Reference: SBML Level~3
Specification for Distributions, Version~1, \sec{uncertspan-class}.)}

\validRule{distrib-20507}{The attribute \token{distrib:\-valueUpper} on
an \UncertSpan must have a value of data type \token{double}.
(Reference: SBML Level~3 Specification for Distributions, Version~1,
\sec{uncertspan-class}.)}

\validRule{distrib-20550}{An \UncertSpan object may define either the attribute \token{distrib:\-valueLower} or \token{distrib:\-varLower}, but not both.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20551}{An \UncertSpan object may define either the attribute \token{distrib:\-valueUpper} or \token{distrib:\-varUpper}, but not both.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20552}{The value of the attribute
\token{distrib:\-type} of an \UncertSpan object must be a subset of the allowed values of SBML data type \primtype{UncertType}, that is, the
value must be one of the following: \val{exter\-nal\-Pa\-ra\-meter},
\val{confidence\-Interval}, \val{credible\-Interval},
\val{in\-ter\-quar\-tile\-Range} or \val{range}. (Reference: SBML Level~3
Specification for Distributions, Version~1,
\sec{uncertparameter-class}.)}

\validRule{distrib-20553}{An \UncertSpan object with a \token{type} of
\val{confidence\-Interval}, \val{credible\-Interval},
\val{in\-ter\-quar\-tile\-Range} or \val{range}
may not define the attributes \token{distrib:\-value}, \token{distrib:\-var}, or \token{distrib:\-de\-fi\-ni\-tion\-URL}.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}

\validRule{distrib-20554}{An \UncertSpan object with a \token{type} of
\val{confidence\-Interval}, \val{credible\-Interval},
\val{in\-ter\-quar\-tile\-Range} or \val{range}
may not define a child \Math or \ListOfUncertParameters object.
(Reference: SBML Level~3 Specification for Distributions, Version~1, \sec{uncertparameter-class}.)}


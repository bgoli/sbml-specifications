% -*- TeX-master: "main"; fill-column: 72 -*-

\section{Validation of SBML documents}
\label{apdx-validation}

An important issue for software systems is being able to determine the
validity of a given SBML document that uses constructs from the
Hierarchical Model Composition package.  This section describes
operational rules for assessing validity.  


\subsection{Validation procedure}
\label{validation-procedure}

Overall, there are two steps to the process of validating a model that
uses the Hierarchical Model Composition package.  First, the structure
and references are 



\subsection{Validation and consistency rules}
\label{validation-rules}

This section summarizes all the conditions that must (or in some cases,
at least \emph{should}) be true of an SBML Level~3 Version~1 model that
uses the Hierarchical Model Composition package.  We use the same
conventions as are used in the SBML Level~3 Version~1 Core specification
document.  In particular, there are different degrees of rule
strictness.  Formally, the differences are expressed in the statement of
a rule: either a rule states that a condition \emph{must} be true, or a
rule states that it \emph{should} be true.  Rules of the former kind are
strict SBML validation rules---a model encoded in SBML must conform to
all of them in order to be considered valid.  Rules of the latter kind
are consistency rules.  To help highlight these differences, we use the
following three symbols next to the rule numbers:

\begin{description}

\item[\hspace*{6.5pt}\vSymbol\vsp] A \vSymbolName indicates a
  \emph{requirement} for SBML conformance. If a model does not follow
  this rule, it does not conform to the Hierarchical Model Composition
  specification.  (Mnemonic intention behind the choice of symbol:
  ``This must be checked.'')

\item[\hspace*{6.5pt}\cSymbol\csp] A \cSymbolName indicates a
  \emph{recommendation} for model consistency.  If a model does not
  follow this rule, it is not considered strictly invalid as far as
  the Hierarchical Model Composition specification is concerned;
  however, it indicates that the model contains a physical or
  conceptual inconsistency.  (Mnemonic intention behind the choice of
  symbol: ``This is a cause for warning.'')

\item[\hspace*{6.5pt}\mSymbol\msp] A \mSymbolName indicates a strong
  recommendation for good modeling practice.  This rule is not
  strictly a matter of SBML encoding, but the recommendation comes
  from logical reasoning.  As in the previous case, if a model does
  not follow this rule, it is not strictly considered an invalid SBML
  encoding.  (Mnemonic intention behind the choice of symbol: ``You're
  a star if you heed this.'')

\end{description}

The validation rules listed in the following subsections are all stated
or implied in the reset of this specification document.  They are
enumerated here for convenience.  Unless explicitly stated, all
validation rules concern objects and attributes specifically defined in
the Hierarchical Model Composition package.


\subsubsection*{General rules about this package} \begin{sbmlenum}

\validRule{comp-10101}{To conform to the  Hierarchical Model Composition
  package specification for SBML Level~3 Version~1, an SBML document must
  declare the use of the following XML Namespace:\\
  ``\uri{http://www.sbml.org/sbml/level3/version1/comp/version1}''.
  (References: SBML L3V1 comp V1 Section~\ref.) }

\validRule{comp-10102}{When appearing in an SBML document, all elements
  and attributes from the SBML Level~3 Version~1 Hierarchical Model
  Composition package must be placed in the XML namespace\\
  ``\uri{http://www.sbml.org/sbml/level3/version1/comp/version1}''.
  (References: SBML L3V1 comp V1 Section~\ref.) }


\end{sbmlenum} \subsubsection*{General rules about identifiers} \begin{sbmlenum}

\validRule{comp-10301}{(Extending the SBML Level~3 Version~1 Core
  validation rule \#10301) Within a \Model or \ExternalModelDefinition
  object, the value of the attribute \token{id} and \token{comp:id} on
  every instance of the following classes of objects must be unique
  across the set of all \token{id} and \token{comp:id} attribute values
  of all such objects in a model: the \Model itself, plus all contained
  \FunctionDefinition, \Compartment, \Species, \Reaction,
  \SpeciesReference, \ModifierSpeciesReference, \Event, and \Parameter
  objects, plus the newly-defined objects \Submodel and \Deletion.
  (References: SBML L3V1 comp V1 Section~\ref{sec:namespaces}.) }

\validRule{comp-10302}{Within an SBMLDocument, the value of the
  attribute \token{id} and \token{comp:id} on every instance of all
  \Model and \ExternalModelDefinition objects must
  be unique across the set of all \token{id} and \token{comp:id}
  attribute values of such identifiers in the SBML document to which
  they belong.
  (References: SBML L3V1 comp V1 Section~\ref{sec:namespaces}.) }

\validRule{comp-10303}{Within a \Model or \ExternalModelDefinition
  object, the value of the attribute \token{comp:id} on every instance
  of all \Port objects must be unique across the set of all
  \token{comp:id} attribute values of all such objects in the model.
  (References: SBML L3V1 comp V1 Section~\ref{sec:namespaces}.) }

\validRule{comp-10304}{The value of a \token{comp:id} attribute must
  always conform to the syntax of the SBML data type \primtype{SId}.
  (References: SBML L3V1 Section~3.1.7.)}
  
\validRule{comp-10308}{The value of the \token{comp:submodelRef} attribute on
  \ReplacedElement objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-submodelrefs}.) }
  
\validRule{comp-10309}{The value of the \token{comp:deletion} attribute on
  \ReplacedElement objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-deletion}.) }
  
\validRule{comp-10310}{The value of the \token{comp:conversionFactor} attribute on
  \ReplacedElement objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-conversionfactor}.) }
  
\end{sbmlenum} \subsubsection*{Rules for the extended \class{SBase} abstract object} \begin{sbmlenum}

\validRule{comp-20101}{Any \SBase objects (that is, all elements inheriting
  from the \SBase class, as defined in this package) may contain at most one 
  instance of the \ListOfReplacedElements object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\extenced-sbase-class}.) }

\validRule{comp-20102}{Apart from the general notes and annotation
  subobjects permitted on all SBML components, a \ListOfReplacedElements
  container object may only contain \ReplacedElement objects. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\extenced-sbase-class}.) }

\validRule{comp-20103}{A \ListOfReplacedElements object may have the optional 
  SBML core attributes \token{metaid} and \token{sboTerm}.  No other attributes 
  from the SBML Level~3 Core namespace or the comp namespace are permitted on 
  a \ListOfReplacedElements object. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\extenced-sbase-class}.) }

\validRule{comp-20104}{The \ListOfReplacedElements in an \SBase object is
  optional, but if present, must not be empty.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\extenced-sbase-class}.) }


\end{sbmlenum} \subsubsection*{Rules for the extended \class{SBML} container object} \begin{sbmlenum}

\validRule{comp-20201}{The \token{sbml} container element must declare whether 
  the comp package alters the mathematics of the model using the attribute
  \token{required}.  
  (References: SBML L3V1 Section~4.1.2.) }
  
\validRule{comp-20202}{The attribute \token{comp:required} on the \token{sbml} 
  container element must have a value of type \token{boolean}.  
  (References: SBML L3V1 Section~4.1.2.) }
  
\validRule{comp-20203}{The attribute \token{comp:required} on the \token{sbml} 
  container element must be set to \token{true} if its
  \Model child contains any \Submodel objects with \Species, \Parameter,
  \Reaction, or \Event objects (directly or indirectly) that have not been
  replaced. 
  (References: SBML L3V1 comp V1 Section~\ref{???}.) }

\validRule{comp-20204}{There may be at most one instance of each of the
  following kind of object on the \token{sbml} container element:  
  \ListOfModelDefinitions and \ListOfExternalModelDefinitions. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbml-class}.) }

\validRule{comp-20205}{The various \token{listOf\_} container objects on 
  the \token{sbml} container element are optional, but if present, such 
  container elements must not be empty. Specifically, if any of the following 
  is present on the \token{sbml} container element, it must not be empty: 
  \ListOfModelDefinitions and \ListOfExternalModelDefinitions.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbml-class}.) }
  
\validRule{comp-20206}{Apart from the general notes and annotation
  subobjects permitted on all SBML components, a \ListOfModelDefinitions
  container object may only contain \ModelDefinition objects.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofmodeldefinitions-class}.) }

\validRule{comp-20207}{Apart from the general notes and annotation
  subobjects permitted on all SBML components, a
  \ListOfExternalModelDefinitions container object may only contain
  \ExternalModelDefinition objects.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofexternalmodeldefinitions-class}.) }
  
\validRule{comp-20208}A \ListOfModelDefinitions object may have the optional 
  SBML core attributes \token{metaid} and \token{sboTerm}.  No other attributes 
  from the SBML Level~3 Core namespace or the comp namespace are permitted on 
  a \ListOfModelDefinitions object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofmodeldefinitions-class}.) }

\validRule{comp-20209}A \ListOfExternalModelDefinitions object may have the optional 
  SBML core attributes \token{metaid} and \token{sboTerm}.  No other attributes 
  from the SBML Level~3 Core namespace or the comp namespace are permitted on 
  a \ListOfExternalModelDefinitions object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofexternalmodeldefinitions-class}.) }

\end{sbmlenum} \subsubsection*{Rules for \class{ExternalModelDefinition} objects} \begin{sbmlenum}

\validRule{comp-20301}{An \ExternalModelDefinition object derives from the SBML
  Level~3 Core \class{SBase} and as such may have the optional attributes
  \token{metaid} and \token{sboTerm}. No other attributes from the SBML
  Level~3 Core namespace are permitted on an \ExternalModelDefinition object.
  (References: SBML L3V1 Section~3.2.) }
   
\validRule{comp-20302}{An \ExternalModelDefinition object derives from the SBML
  Level~3 Core \class{SBase} and as such may have the optional subobjects
  notes and annotation. No other elements from the SBML
  Level~3 Core namespace are permitted on an \ExternalModelDefinition object.
  (References: SBML L3V1 Section~3.2.) }
   
\validRule{comp-20303}{An ExternalModelDefinition object must have the
  required attributes \token{comp:id} and \token{comp:source}, and may have
  the optional attributes \token{comp:modelRef} and \token{comp:md5}.
  No other attributes from the comp namespace are permitted on an
  \ExternalModelDefinition object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\externalmodeldefinition-class}.) }

\validRule{comp-20304}{The value of the \token{comp:source} attribute on an
  \ExternalModelDefinition object must point to a SBML Level 3 document.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\externalmodeldefinition-class}.) }

\validRule{comp-20305}{The value of the \token{comp:modelRef} attribute on an
  \ExternalModelDefinition object must be the \token{id} of a \Model
  in the SBML document pointed to by the \token{comp:source} attribute.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\externalmodeldefinition-class}.) }

\consistencyRule{comp-20306}{The value of the \token{comp:md5} attribute on an
  \ExternalModelDefinition object should match the
  calculated MD5 checksum of the SBML document pointed to by the 
  \token{comp:source} attribute.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\externalmodeldefinition-class}.) }

\validRule{comp-20307}{The value of the \token{comp:source} attribute on
  \ExternalModelDefinition objects must always conform to the syntax of
  the XML Schema 1.0 data type \primtype{anyURI}.
  (References: SBML L3V1 comp V1 
  Section~\ref{sec:\listofexternalmodeldefinitions-class}.) }

\validRule{comp-20308}{The value of \token{comp:modelRef} attributes on
  \ExternalModelDefinition objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 
  Section~\ref{sec:\listofexternalmodeldefinitions-class}.) }

\validRule{comp-20309}{The value of the \token{comp:md5} attribute on
  \ExternalModelDefinition objects must always conform to the syntax of
  type \primtype{string}.
  (References: SBML L3V1 comp V1 
  Section~\ref{sec:\listofexternalmodeldefinitions-class}.) }

\end{sbmlenum} \subsubsection*{Rules for \class{ModelDefinition} objects} \begin{sbmlenum}

\validRule{comp-20301}{An \ModelDefinition object derives from the SBML
  Level~3 Core \class{Model} and as such must follow the same restrictions 
  present on Level~3 Core \Model objects.
  This includes any validation rules from the SBML Level 3 Version 1
  core specification as well as this document.
   (References: SBML L3V1 Section~4.2.) }

\end{sbmlenum} \subsubsection*{Rules for extended \class{Model} objects} \begin{sbmlenum}

\validRule{comp-20401}{There may be at most one instance of each of the
  following kind of object on the \Model: \ListOfSubmodels and \ListOfPorts. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\model-class}.) }

\validRule{comp-20402}{The various \token{listOf\_} container objects on 
  the \Model element are optional, but if present, such 
  container elements must not be empty. Specifically, if any of the following 
  is present on the \Model element, it must not be empty: 
  \ListOfSubmodels and \ListOfPorts.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\model-class}.) }
  
\validRule{comp-20403}{Apart from the general notes and annotation
  subobjects permitted on all SBML components, a \ListOfSubmodels
  container object may only contain \Submodel objects.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\model-class}.) }

\validRule{comp-20404}{Apart from the general notes and annotation
  subobjects permitted on all SBML components, a
  \ListOfPorts container object may only contain \Port objects.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\model-class}.) }
  
\validRule{comp-20405}A \ListOfSubmodels object may have the optional 
  SBML core attributes \token{metaid} and \token{sboTerm}.  No other attributes 
  from the SBML Level~3 Core namespace or the comp namespace are permitted on 
  a \ListOfSubmodels object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\model-class}.) }

\validRule{comp-20406}A \ListOfPorts object may have the optional 
  SBML core attributes \token{metaid} and \token{sboTerm}.  No other attributes 
  from the SBML Level~3 Core namespace or the comp namespace are permitted on 
  a \ListOfPorts object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\model-class}.) }

\end{sbmlenum} \subsubsection*{Rules for \class{Submodel} objects} \begin{sbmlenum}

\validRule{comp-20501}{An \Submodel object derives from the SBML
  Level~3 Core \class{SBase} and as such may have the optional attributes
  \token{metaid} and \token{sboTerm}. No other attributes from the SBML
  Level~3 Core namespace are permitted on an \Submodel object.
  (References: SBML L3V1 Section~3.2.) }
   
\validRule{comp-20502}{An \Submodel object derives from the SBML
  Level~3 Core \class{SBase} and as such may have the optional subobjects
  notes and annotation. No other elements from the SBML
  Level~3 Core namespace are permitted on an \Submodel object.
  (References: SBML L3V1 Section~3.2.) }
   
\validRule{comp-20503}{There may be at most one ListOfDeletions container
  object on the \Submodel. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofdeletions-class}.) }

\validRule{comp-20504}{The ListOfDeletions container object on 
  the \Submodel element is optional, but if present, must not be empty. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofdeletions-class}.) }
  
\validRule{comp-20505}{Apart from the general notes and annotation
  subobjects permitted on all SBML components, a \ListOfDeletions
  container object may only contain \Deletion objects.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofdeletions-class}.) }

\validRule{comp-20506}A \ListOfDeletions object may have the optional 
  SBML core attributes \token{metaid} and \token{sboTerm}.  No other attributes 
  from the SBML Level~3 Core namespace or the comp namespace are permitted on 
  a \ListOfDeletions object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\listofdeletions-class}.) }

\validRule{comp-20507}{A \Submodel object must have the
  required attributes \token{comp:id} and \token{comp:modelRef}, and may have
  the optional attributes \token{comp:lengthConversionFactor},
  \token{comp:areaConversionFactor}, \token{comp:volumeConversionFactor},
  \token{comp:substanceConversionFactor}, \token{comp:timeConversionFactor}, and
  \token{comp:extentConversionFactor}.
  No other attributes from the comp namespace are permitted on a
  \Submodel object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-class}.) }

\validRule{comp-20508}{The value of the \token{comp:modelRef} attribute 
  on \Submodel objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-modelref}.) }

\validRule{comp-20509}{The value of the \token{comp:lengthConversionFactor} attribute 
  on \Submodel objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20510}{The value of the \token{comp:areaConversionFactor} attribute 
  on \Submodel objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20511}{The value of the \token{comp:volumeConversionFactor} attribute 
  on \Submodel objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20512}{The value of the \token{comp:substanceConversionFactor} attribute 
  on \Submodel objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20513}{The value of the \token{comp:timeConversionFactor} attribute 
  on \Submodel objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20514}{The value of the \token{comp:extentConversionFactor} attribute 
  on \Submodel objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20515}{The \token{comp:modelRef} attribute on a \Submodel must
  be the identifier of a \Model, \ModelDefinition, or
  \ExternalModelDefinition object in the same \class{sbml} element as the
  \Submodel. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-modelref}.) }

\validRule{comp-20516}{The \token{comp:lengthConversionFactor} attribute
   on a \Submodel object must be the identifier of a \Parameter object in the 
   same \Model as the \Submodel.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20517}{The \token{comp:areaConversionFactor} attribute
   on a \Submodel object must be the identifier of a \Parameter object in the 
   same \Model as the \Submodel.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20518}{The \token{comp:volumeConversionFactor} attribute
   on a \Submodel object must be the identifier of a \Parameter object in the 
   same \Model as the \Submodel.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20519}{The \token{comp:substanceConversionFactor} attribute
   on a \Submodel object must be the identifier of a \Parameter object in the 
   same \Model as the \Submodel.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20520}{The \token{comp:timeConversionFactor} attribute
   on a \Submodel object must be the identifier of a \Parameter object in the 
   same \Model as the \Submodel.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }

\validRule{comp-20521}{The \token{comp:extentConversionFactor} attribute
   on a \Submodel object must be the identifier of a \Parameter object in the 
   same \Model as the \Submodel.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\submodel-conversion}.) }


\end{sbmlenum} \subsubsection*{Rules for the \class{SBaseRef} abstract object} \begin{sbmlenum}

% was 20204 - question ??
\validRule{comp-20601}{The value of a \token{comp:portRef} attribute on an \SBaseRef
  object must be the identifier of a \Port object from the referenced
  \Model.  
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-portref}.) }

\validRule{comp-20602}{The value of an \token{comp:idRef} attribute on an \SBaseRef
  object must be the identifier of an object from the referenced \Model
  within the SId namespace for that model.  This includes elements with
  \token{id} attributes which are defined in packages other than Level 3 core or
  this comp package. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-idref}.) }

\validRule{comp-20603}{The value of a \token{comp:unitRef} attribute on an \SBaseRef
  object must be the identifier of a \\UnitDefinition object from the
  referenced \Model.  
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-unitref}.) }

\validRule{comp-20604}{The value of a \token{comp:metaIdRef} attribute on an \SBaseRef
  object must be the value of a \token{comp:metaid} attribute on any element
  contained in the referenced \Model.  This includes elements with \token{metaid}
  attributes which are defined in packages other than Level 3 core or
  this comp package. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-metaidref}.) }

\validRule{comp-20605}{If an \SBaseRef object contains an \SBaseRef child,
  it must point to a \Submodel element. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-recursive-sbaseref}.) }

\validRule{comp-20606}{The value of the \token{comp:portRef} attribute 
  on \SBaseRef objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-portref}.) }

\validRule{comp-20607}{The value of the \token{comp:idRef}
  attribute on \SBaseRef objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-idref}.) }

\validRule{comp-20608}{The value of the \token{comp:unitRef} attribute on
  \SBaseRef objects must always conform to the syntax of the SBML data
  type \primtype{UnitSId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-unitref}.) }

\validRule{comp-20609}{The value of the \token{comp:metaIdRef} attributes on
  \SBaseRef objects must always conform to the syntax of the XML data
  type \primtype{ID}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\sbaseref-metaidref}.) }

\end{sbmlenum} \subsubsection*{Rules for \class{Port} objects} \begin{sbmlenum}

\validRule{comp-20701}{A \Port object must point to another object; that is,
  a \Port object must define one of the attributes 
  \token{comp:idRef}, \token{comp:unitRef}, or \token{comp:metaIdRef}. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\port-class}.) }

\validRule{comp-20702}{A \Port object can only point to one other object; that is,
  a \Port object can define only one of the attributes 
  \token{comp:idRef}, \token{comp:unitRef}, or \token{comp:metaIdRef}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\port-class}.) }

\validRule{comp-20703}{A \Port object must have the
  required attribute \token{comp:id}, and one, and only one, of the attributes  
  \token{comp:idRef}, \token{comp:unitRef}, or \token{comp:metaIdRef}.
  No other attributes from the comp namespace are permitted on a
  \Port object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\port-class}.) }

\validRule{comp-20704}{No two \Port objects in the same \Model may
  reference the same XML element.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\port-class}.) }

\end{sbmlenum} \subsubsection*{Rules for \class{Deletion} objects} \begin{sbmlenum}

\validRule{comp-20801}{A \Deletion object must point to another object; that is,
  a \Deletion object must define one of the attributes \token{comp:portRef}, 
  \token{comp:idRef}, \token{comp:unitRef}, or \token{comp:metaIdRef}. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\deletion-class}.) }

\validRule{comp-20802}{A \Deletion object can only point to one other object; that is,
  a \Deletion object can define only one of the attributes  \token{comp:portRef}, 
  \token{comp:idRef}, \token{comp:unitRef}, or \token{comp:metaIdRef}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\deletion-class}.) }

\validRule{comp-20803}{A \Deletion object must have the
  required attribute \token{comp:id}, and one, and only one, of the attributes
  \token{comp:portRef}, 
  \token{comp:idRef}, \token{comp:unitRef}, or \token{comp:metaIdRef}.
  No other attributes from the comp namespace are permitted on a
  \Deletion object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\deletion-class}.) }

\end{sbmlenum} \subsubsection*{Rules for \class{ReplacedElement} objects} \begin{sbmlenum}

\validRule{comp-20901}{A \ReplacedElement object must point to another object; that is,
  a \ReplacedElement object must define one of the attributes \token{comp:portRef}, 
  \token{comp:idRef}, \token{comp:unitRef}, \token{comp:metaIdRef}, or \token{comp:deletion}. 
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-class}.) }

\validRule{comp-20902}{A \ReplacedElement object can only point to one other object; that is,
  a \ReplacedElement object can define only one of the attributes  \token{comp:portRef}, 
  \token{comp:idRef}, \token{comp:unitRef}, \token{comp:metaIdRef}, or \token{comp:deletion}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-class}.) }

\validRule{comp-20903}{A \ReplacedElement object must have the
  required attributes \token{comp:submodelRef} and \token{identical}, and one, 
  and only one, of the attributes \token{comp:portRef}, 
  \token{comp:idRef}, \token{comp:unitRef}, \token{comp:metaIdRef}, or \token{comp:deletion}.
  It may also have the optional attribute \token{comp:conversionFactor}.
  No other attributes from the comp namespace are permitted on a
  \ReplacedElement object.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-class}.) }

\validRule{comp-20903}{The value of a \token{comp:submodelRef} attribute on a
  \ReplacedElement object must be the identifier of a \Submodel object
  from the parent \Model of the ReplacedElement.  
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-submodelref}.) }

\validRule{comp-20904}{The value of a \token{comp:deletion} attribute on a
  \ReplacedElement object must be the identifier of a \Deletion object
  from the parent \Model of the \ReplacedElement.  
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-identical}.) }

\validRule{comp-20905}{The value of a \token{conversionFactor} attribute on a
  \ReplacedElement object must be the identifier of a \Parameter object
  from the parent \Model of the ReplacedElement.  
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-conversionfactor}.) }

\validRule{comp-20906}{The value of the \token{comp:submodelRef} attribute on
  \ReplacedElement objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-submodelrefs}.) }
  
\validRule{comp-20907}{The value of the \token{comp:deletion} attribute on
  \ReplacedElement objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-deletion}.) }
  
\validRule{comp-20908}{The value of the \token{comp:conversionFactor} attribute on
  \ReplacedElement objects must always conform to the syntax of
  the SBML data type \primtype{SId}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-conversionfactor}.) }
  
\validRule{comp-20909}{The value of the \token{comp:identical} attribute on
  \ReplacedElement objects must always conform to the syntax of
  the SBML data type \primtype{bool}.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-identical}.) }

\validRule{comp-20910}{No two \ReplacedElement objects in the same \Model
  may reference the same XML element unless that element is a \Deletion.
  (References: SBML L3V1 comp V1 Section~\ref{sec:\replacedelement-class}.) }
  







\end{sbmlenum} \subsubsection*{General rules about circular references in models} \begin{sbmlenum}

\validRule{comp10401}{No \ExternalModelDefinition may reference an
  \ExternalModelDefinition in a different SBML document that in turn
  refers to the original \ExternalModelDefinition object, whether
  directly or indirectly through a chain of \ExternalModelDefinition objects.} 

\validRule{comp10402}{No \Model may contain a \Submodel which references
  itself.  That is, the \token{id} attribute of a \Model may not match the
  \token{modelRef} attribute on any of its \Submodel objects.} 

\validRule{comp10403}{No \Model may contain a \Submodel which references
  itself indirectly.  That is, the \token{modelRef} attribute of a \Submodel may
  not point to a \Model, any of whose \Submodel objects point to the original
  \Model, whether directly or indirectly through a chain of
  \Model/\Submodel pairs.} 


\end{sbmlenum} \subsubsection*{General rules about class inheritance} \begin{sbmlenum}

\end{sbmlenum} \subsubsection*{Rules for \class{SBaseRef}, \class{Deletion}, \class{Port} and \class{ReplacedElement} objects} \begin{sbmlenum}


\validRule{comp20213}{If the value of the \token{identical} attribute on a
  \ReplacedElement object is \val{true}, the parent element of the
  \ListOfReplacedElements to which the \ReplacedElement belongs must be
  the same class as the referenced element.} 

\validRule{comp20214}{If the value of the \token{identical} attribute on a
  \ReplacedElement object is \val{true}, the parent element of the
  \ListOfReplacedElements to which the \ReplacedElement belongs must
  define all of the attributes present on the referenced element.  This
  includes attributes from other namespaces, such as from packages other
  than Level 3 core and this 'comp' package.} 

\validRule{comp20215}{If the value of the \token{identical} attribute on
  a \ReplacedElement object is \val{true}, the parent element of the
  \ListOfReplacedElements to which the \ReplacedElement belongs must
  only define attributes present on the referenced element, with the
  exception of the \token{id} and \token{metaid} attributes, which may
  be added even if not present on the referenced element.}

\validRule{comp20216}{If the value of the \token{identical} attribute on
  a \ReplacedElement object is \val{true}, all attributes of the parent
  element of the \ListOfReplacedElements to which the \ReplacedElement
  belongs (including attributes from other namespaces) must be identical
  to the corresponding attributes of the referenced element, with the
  exception of the \token{id} and \token{metaid} attributes, which may
  be anything, and with the exception of attributes of type
  \primtype{SIdRef}, \primtype{UnitSIdRef}, \primtype{PortSIdRef}, and
  \primtype{IDREF}, which must now reference elements of the parent
  model which themselves are replacements for the original target of the
  reference attribute.  Those referenced replacements need not be
  flagged with 'identical=true', and need not be identical to the
  elements they replace.  If any attributes define a numerical value in
  the submodel that would be converted to a new value in the parent
  model though the use of a conversionFactor, that attribute must be set
  to be equal to the new numerical value.}

\validRule{comp20217}{If the value of the \token{identical} attribute on
  a \ReplacedElement object is \val{true}, the children of the parent
  element of the \ListOfReplacedElements to which the \ReplacedElement
  belongs must be identical to the corresponding children of the
  referenced element, with the exception of any child
  \ListOfReplacedElements objects (which have no restrictions).
  'Identical' means these child objects themselves must follow
  validation rules comp20213, comp20214, comp20215, comp20216, and
  comp20217.}

\validRule{comp20218}{(warning) If the \token{identical} attribute on a
  \ReplacedElement object is not set, all attributes with defined values
  on the referenced element should be defined on the parent element of
  the \ListOfReplacedElements to which the ReplacedElement belongs.} 

\validRule{comp20219}{(warning) If the \token{identical} attribute on a
  \ReplacedElement object is not set, the parent element of the
  \ListOfReplacedElements to which the \ReplacedElement belongs should
  contain the same number and type of children as the referenced
  element, with the exception of \ListOfReplacedElements children.} 

\validRule{comp20220}{\SBaseRef objects may define \token{port},
  \token{idRef}, \token{unitRef}, and \token{metaIdRef} attributes.
  \SBaseRef objects which are not \Port, \Deletion, or ReplacedElement
  objects may not define any other attributes from the comp namespace.}

\end{sbmlenum}

% -*- TeX-master: "sbml-level-3-version-2-core"; fill-column: 66 -*-
% ----------------------------------------------------------------
\begin{blockChanged}
\section{A mathematical technique for maintaining unit consistency in a kinetic law with variable stoichiometry}
\label{apdx:variable-species-reference-units}

\emph{(Appendix contributed by Chris Myers, University of Utah.)}

Section~\ref{subsec:speciesreference} describes how the stoichiometry of a \SpeciesReference can be changed as part of a simulation.  This can be useful in some cases, such as reactions where the stoichiometry depends upon pH.

However, it can be difficult to get the \KineticLaw of such reactions to maintain the correct units as the stoichiometry of the reaction changes.  One solution to this is to use the form:

    \begin{linenomath}
      \begin{larray*}
        kr \cdot {K_{eq}}^{n-1} \cdot A^n - k_r \cdot B \\
      \end{larray*}
    \end{linenomath}

Where $A$ and $B$ are \Species with units of mole, $k_r$ is the in units of ${second}^{-1}$, $K_{eq}$ ($\frac{k_f}{k_r}$) is in units of ${mole}^{-1}$.

This results in a rate law with units of ${mole}/{second}$ as desired, regardless of the value of $n$, the stoichiometry of $A$.

This kinetic law is a reasonable approximation of

    \begin{linenomath}
      \begin{larray*}
             A + A &\rightarrow& A2 \\
            A2 + A &\rightarrow& A3 \\
        A(n-1) + A &\rightarrow& An \\
      \end{larray*}
    \end{linenomath}

So, if one makes this the default kinetic law, the problem is solved.


\end{blockChanged}
